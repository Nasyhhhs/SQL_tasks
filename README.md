# SQL_tasks
Здесь собираю решения интересных задач по SQL. Для отработки данных скриптов подняла локальную БД через DBeaver, скрипты создания таблиц находятся в папке scripts настоящего репозитория.
### Task_1 (Схема indexes)
Имеется таблица indexes_int со значениями индексов (тип integer) и таблица indexes_var с типом данных varchar. Необходимо найти соответствия индексов в данных таблицах, избавившись от лишних символов(пробелы, буквы и тп) во второй таблице.

<img width="467" alt="2023-08-09_195805" src="https://github.com/Nasyhhhs/SQL_tasks/assets/109277211/a4b238a2-974c-42b2-bdcb-92b196a68a55">


### Task_2 (Схема citizens)
Имеется таблица numbers(скрипт numbers) со следующими полями:
"Id гражданина" int, "Номер телефона" bigint "Вероятность" float
Необходимо выбрать  телефоны, у которых проставлена наибольшая вероятность, для каждого гражданина.


<img width="460" alt="2023-08-09_203749" src="https://github.com/Nasyhhhs/SQL_tasks/assets/109277211/c23e9a0c-5995-41d2-a78c-6a2e22a95aff">

### Task_3 (Схема citizens)
Имеется таблица age_gender со следующими полями:
"Возраст гражданина" int, "Пол гражданина" int, "Телефон" bigint
Также таблица registration с полями
id int,"Телефон" bigint,"Регистрация" varchar
Задача добавить столбец в age_gender со значением «1», если гражданин содержится в registration и является москвичем (наличие гражданина проверять по номеру телефона).

<img width="450" alt="2023-08-09_233421" src="https://github.com/Nasyhhhs/SQL_tasks/assets/109277211/5e035e93-dcdf-4732-aedd-11162c4bbadf">


